USE GD1C2020

SELECT CLIENTE_DNI, COUNT(*) FROM gd_esquema.Maestra
GROUP BY CLIENTE_DNI
HAVING COUNT(*) > 1

SELECT CLIENTE_DNI, CLIENTE_APELLIDO, CLIENTE_NOMBRE FROM gd_esquema.Maestra
WHERE CLIENTE_DNI = '65334031'

SELECT ESTADIA_CODIGO, COUNT(*) FROM gd_esquema.Maestra
GROUP BY ESTADIA_CODIGO
HAVING COUNT(*) > 0
ORDER BY COUNT(*)

SELECT AVION_IDENTIFICADOR, AVION_MODELO, COUNT(*), VUELO_CODIGO FROM GD1C2020.gd_esquema.Maestra
GROUP BY AVION_IDENTIFICADOR, AVION_MODELO, VUELO_CODIGO
HAVING COUNT(*) > 1
ORDER BY VUELO_CODIGO

SELECT  DISTINCT RUTA_AEREA_CODIGO, RUTA_AEREA_CIU_ORIG, RUTA_AEREA_CIU_DEST FROM gd_esquema.Maestra
WHERE RUTA_AEREA_CODIGO IS NOT NULL
ORDER BY RUTA_AEREA_CODIGO

SELECT DISTINCT RUTA_AEREA_CODIGO, COUNT(*) FROM gd_esquema.Maestra
GROUP BY RUTA_AEREA_CODIGO

SELECT BUTACA_NUMERO, BUTACA_TIPO, VUELO_CODIGO, AVION_IDENTIFICADOR, AVION_MODELO, FACTURA_NRO FROM gd_esquema.Maestra

-- Me trae todos los clientes diferentes
SELECT  CLIENTE_APELLIDO, CLIENTE_NOMBRE, CLIENTE_DNI, CLIENTE_FECHA_NAC, CLIENTE_MAIL, CLIENTE_TELEFONO
FROM gd_esquema.Maestra C
WHERE C.CLIENTE_DNI IS NOT NULL
GROUP BY C.CLIENTE_APELLIDO, C.CLIENTE_NOMBRE, C.CLIENTE_DNI, C.CLIENTE_FECHA_NAC, C.CLIENTE_MAIL, C.CLIENTE_TELEFONO
ORDER BY C.CLIENTE_DNI

SELECT SUCURSAL_DIR, SUCURSAL_MAIL, SUCURSAL_TELEFONO FROM gd_esquema.Maestra
WHERE SUCURSAL_DIR IS NOT NULL
GROUP BY SUCURSAL_DIR, SUCURSAL_MAIL, SUCURSAL_TELEFONO
ORDER BY SUCURSAL_MAIL

select EMPRESA_RAZON_SOCIAL
from gd_esquema.Maestra
where ESTADIA_CODIGO is not null
group by EMPRESA_RAZON_SOCIAL

select EMPRESA_RAZON_SOCIAL
from gd_esquema.Maestra
where PASAJE_CODIGO is not null
group by EMPRESA_RAZON_SOCIAL
order by EMPRESA_RAZON_SOCIAL

SELECT DISTINCT RUTA_AEREA_CIU_ORIG
FROM gd_esquema.Maestra
WHERE RUTA_AEREA_CIU_ORIG IS NOT NULL
ORDER BY RUTA_AEREA_CIU_ORIG

SELECT DISTINCT RUTA_AEREA_CIU_DEST
FROM gd_esquema.Maestra
WHERE RUTA_AEREA_CIU_DEST IS NOT NULL
ORDER BY RUTA_AEREA_CIU_DEST

-- Me trae los distintos tipos de habitacion con su codigo (5 tipos)
SELECT TIPO_HABITACION_CODIGO, TIPO_HABITACION_DESC FROM GD1C2020.gd_esquema.Maestra
WHERE TIPO_HABITACION_CODIGO IS NOT NULL
GROUP BY TIPO_HABITACION_CODIGO, TIPO_HABITACION_DESC
ORDER BY 1

SELECT * FROM GD1C2020.gd_esquema.Maestra
WHERE HOTEL_CALLE IS NOT NULL

--- Me trae los distintos aviones y su modelo --- 
SELECT AVION_IDENTIFICADOR, AVION_MODELO FROM GD1C2020.gd_esquema.Maestra
WHERE AVION_IDENTIFICADOR IS NOT NULL
GROUP BY AVION_IDENTIFICADOR, AVION_MODELO
ORDER BY AVION_IDENTIFICADOR

--- Me trae los distintos tipos de butaca ---
SELECT DISTINCT BUTACA_TIPO FROM GD1C2020.gd_esquema.Maestra
WHERE BUTACA_TIPO IS NOT NULL
ORDER BY BUTACA_TIPO

SELECT HOTEL_CALLE, HOTEL_NRO_CALLE, HOTEL_CANTIDAD_ESTRELLAS, grupo_hotelario_codigo
FROM gd_esquema.Maestra JOIN LOS_BORBOTONES.GRUPO_HOTELARIO ON EMPRESA_RAZON_SOCIAL = grupo_hotelario_razon_social
WHERE EMPRESA_RAZON_SOCIAL IS NOT NULL AND HOTEL_CALLE IS NOT NULL
GROUP BY HOTEL_CALLE, HOTEL_NRO_CALLE, HOTEL_CANTIDAD_ESTRELLAS, grupo_hotelario_codigo
ORDER BY grupo_hotelario_codigo, HOTEL_CALLE

SELECT DISTINCT HOTEL_CALLE, HOTEL_NRO_CALLE, EMPRESA_RAZON_SOCIAL FROM GD1C2020.gd_esquema.Maestra
WHERE HOTEL_CALLE IS NOT NULL
ORDER BY 3

SELECT RA.RUTA_AEREA_CODIGO, C1.ciudad_codigo, C2.ciudad_codigo
FROM GD1C2020.gd_esquema.Maestra RA 
	INNER JOIN LOS_BORBOTONES.CIUDAD C1 ON RA.RUTA_AEREA_CIU_ORIG = C1.ciudad_detalle
	INNER JOIN LOS_BORBOTONES.CIUDAD C2 ON RA.RUTA_AEREA_CIU_DEST = C2.ciudad_detalle
WHERE RUTA_AEREA_CODIGO IS NOT NULL
GROUP BY RA.RUTA_AEREA_CODIGO, C1.ciudad_codigo, C2.ciudad_codigo
ORDER BY RA.RUTA_AEREA_CODIGO

SELECT DISTINCT BUTACA_NUMERO, BUTACA_TIPO, AVION_IDENTIFICADOR FROM GD1C2020.gd_esquema.Maestra
WHERE BUTACA_NUMERO IS NOT NULL
ORDER BY BUTACA_NUMERO, BUTACA_TIPO, AVION_IDENTIFICADOR

------------------------------ PRUEBAS DE LAS MIGRACIONES ------------------------------ 

-- Me trae todos los clientes de TABLA CLIENTE CREADA -- 237522 clientes diferentes
SELECT * FROM GD1C2020.LOS_BORBOTONES.CLIENTE

-- Me trae todas las sucursales de TABLA SUCURSAL CREADA -- 6 sucursales
SELECT * FROM GD1C2020.LOS_BORBOTONES.SUCURSAL

-- Me trae todas las aerolineas de TABLA AEROLINEA CREADA -- 13 aerolineas diferentes
SELECT * FROM GD1C2020.LOS_BORBOTONES.AEROLINEA

-- Me trae todos los aviones y sus modelos de TABLA AVION CREADA --  33 aviones diferentes
SELECT * FROM GD1C2020.LOS_BORBOTONES.AVION

-- Me trae todas las ciudades de TABLA CIUDAD CREADA -- 38 ciudades diferentes
SELECT * FROM GD1C2020.LOS_BORBOTONES.CIUDAD

-- Me trae todos los tipos de butaca de TABLA TIPO_BUTACA CREADA -- 4 tipos de butaca diferentes
SELECT * FROM GD1C2020.LOS_BORBOTONES.TIPO_BUTACA

-- Me trae todos los tipos de grupos hotelarios de TABLA GRUPOS_HOTELARIOS CREADA -- 9 grupos hotelarios distintos
SELECT * FROM GD1C2020.LOS_BORBOTONES.GRUPO_HOTELARIO

-- Me trae todos los hoteles de TABLA HOTEL CREADA -- 20 hoteles diferentes
SELECT * FROM GD1C2020.LOS_BORBOTONES.HOTEL

-- Me trae todos los tipos de habitacion de TABLA TIPO_HABITACION CREADA -- 5 tipos de habitacion diferentes
SELECT * FROM GD1C2020.LOS_BORBOTONES.TIPO_HABITACION

-- Posible codigo para migracion de rutas aereas
SELECT RA.RUTA_AEREA_CODIGO, C1.ciudad_codigo, C2.ciudad_codigo
FROM GD1C2020.gd_esquema.Maestra RA 
	INNER JOIN LOS_BORBOTONES.CIUDAD C1 ON RA.RUTA_AEREA_CIU_ORIG = C1.ciudad_detalle
	INNER JOIN LOS_BORBOTONES.CIUDAD C2 ON RA.RUTA_AEREA_CIU_DEST = C2.ciudad_detalle
WHERE RUTA_AEREA_CODIGO IS NOT NULL
GROUP BY RA.RUTA_AEREA_CODIGO, C1.ciudad_codigo, C2.ciudad_codigo
ORDER BY RA.RUTA_AEREA_CODIGO